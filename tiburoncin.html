<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Kawaii Gothic Shark Deluxe - 10 niveles</title>
<style>
    body {
        margin: 0;
        font-family: "Comic Sans MS", cursive;
        background: #150818;
        overflow: hidden;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
    }
    canvas { 
        border: 4px solid #ffb7e8;
        box-shadow: 0 0 20px #ff7be6;
    }
    .ui {
        position: absolute;
        color: #ffccf5;
        text-shadow: 0 0 5px #ff7be6;
        font-size: 22px;
    }
    #score { top: 10px; left: 10px; }
    #lives { top: 40px; left: 10px; }
    #level { top: 70px; left: 10px; }
    #goal { top: 100px; left: 10px; }
    #buttons { top: 10px; right: 10px; display: flex; flex-direction: column; }
    button { margin: 5px; padding: 8px 12px; border-radius: 6px; border: 2px solid #ff97e8; background: #1a0921; color: #ffccf5; font-size: 16px; cursor: pointer; }
    #tutorial, #message, #bossInfo, #gameOverScreen { 
        position: absolute; 
        width: 80%; 
        height: 80%; 
        background: rgba(0,0,0,0.8); 
        color: #ffccf5; 
        border: 3px solid #ff97e8; 
        border-radius: 12px; 
        text-align: center; 
        padding: 20px; 
        display: none; 
    }
    #tutorial p, #message p, #bossInfo p, #gameOverScreen p { font-size: 20px; }
    select { margin-top: 10px; }
</style>
</head>
<body>

<canvas id="game" width="900" height="550"></canvas>

<div id="score" class="ui">â™¡ Almas: 0</div>
<div id="lives" class="ui">ðŸ’– Vidas: 3</div>
<div id="level" class="ui">Nivel: 1</div>
<div id="goal" class="ui">Meta: 5 Almas (corazones)</div>

<div id="buttons" class="ui">
    <button id="startBtn">Iniciar Juego</button>
    <button id="pauseBtn">Pausa</button>
    <button id="resumeBtn" style="display:none;">Continuar</button>
    <label>Skin TiburÃ³n:
        <select id="skinSelect">
            <option value="pink">Rosa Kawaii</option>
            <option value="goth">GÃ³tico</option>
            <option value="pastel">Pastel MÃ¡gico</option>
        </select>
    </label>
    <button id="retryBtn" style="display:none;">Reintentar</button>
</div>

<div id="tutorial">
    <h2>CÃ³mo jugar</h2>
    <p>Controla tu tiburÃ³n con las teclas WASD o las flechas.<br>
    Evita a los enemigos kawaii y recolecta los corazones â™¡.<br>
    Cada nivel tiene una cantidad mÃ­nima de corazones para pasar al siguiente.</p>
    <button id="tutorialBtn">Â¡Comenzar Nivel!</button>
</div>

<div id="message">
    <h2 id="messageText">Â¡Perfecto!</h2>
    <button id="nextLevelBtn">Siguiente Nivel</button>
</div>

<div id="bossInfo">
    <h2>Nivel 10: Jefe Final</h2>
    <p>El jefe tiene un punto dÃ©bil en el centro.<br>
    Evita sus ataques y toca su punto dÃ©bil varias veces para derrotarlo.</p>
    <button id="startBossBtn">Â¡Comenzar Nivel 10!</button>
</div>

<div id="gameOverScreen">
    <h2>Â¡Perdiste!</h2>
    <p>Has perdido todas tus vidas.</p>
    <button id="gameOverRetryBtn">Reintentar</button>
</div>

<audio id="lofiMusic" loop autoplay>
    <source src="data:audio/mp3;base64,//uQxAAAAAAAAAAAAAAAAAAAA..." type="audio/mp3">
</audio>

<script>
// ==================== VARIABLES ====================
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

let score = 0;
let lives = 3;
let level = 1;
let goal = 5;
let paused = false;
let gameStarted = false;
let inBossLevel = false;

// SKINS
const skins = {
    pink: { body: "#ff94d6", tail: "#8a00c6", eye: "#000" },
    goth: { body: "#5a0099", tail: "#000", eye: "#ff00ff" },
    pastel: { body: "#ffe3fa", tail: "#c69cff", eye: "#000" }
};
let currentSkin = "pink";

// TIBURÃ“N
const shark = { x:450, y:280, size:45, speed:4, vx:0, vy:0, blink:0, finWave:0 };

// CORAZONES
let hearts = [];
let heartsInterval;

// ENEMIGOS
let enemies = [];
let enemiesInterval;

// NIVEL 10 Jefe
let boss = null;
let bossHP = 10;

// FONDOS POR NIVEL
const levelBackgrounds = [
    '#2a0b38','#38144f','#44225d','#50306b','#5b3c79','#674987','#735495','#8060a5','#8c6db3','#9939d1'
];

// MENSAJES MOTIVADORES
const levelMessages = [
    "Â¡Perfecto!","Â¡Genial!","Â¡IncreÃ­ble!","Â¡FantÃ¡stico!","Â¡Sensacional!",
    "Â¡Asombroso!","Â¡Maravilloso!","Â¡Impresionante!","Â¡EsplÃ©ndido!","Â¡Victoria Suprema!"
];

// META DE CORAZONES POR NIVEL
const levelGoals = [5,6,7,8,9,10,11,12,13,15];

// ==================== BOTONES ====================
const startBtn = document.getElementById("startBtn");
const pauseBtn = document.getElementById("pauseBtn");
const resumeBtn = document.getElementById("resumeBtn");
const skinSelect = document.getElementById("skinSelect");
const retryBtn = document.getElementById("retryBtn");
const tutorial = document.getElementById("tutorial");
const tutorialBtn = document.getElementById("tutorialBtn");
const message = document.getElementById("message");
const messageText = document.getElementById("messageText");
const nextLevelBtn = document.getElementById("nextLevelBtn");
const bossInfo = document.getElementById("bossInfo");
const startBossBtn = document.getElementById("startBossBtn");
const gameOverScreen = document.getElementById("gameOverScreen");
const gameOverRetryBtn = document.getElementById("gameOverRetryBtn");

startBtn.onclick = () => { tutorial.style.display = "block"; };
tutorialBtn.onclick = () => { tutorial.style.display = "none"; startLevel(); };
skinSelect.onchange = () => { currentSkin = skinSelect.value; };
retryBtn.onclick = () => { resetLevel(); retryBtn.style.display="none"; };
startBossBtn.onclick = () => { bossInfo.style.display="none"; startLevel(true); };
gameOverRetryBtn.onclick = () => { location.reload(); };

// PAUSA Y REANUDAR
pauseBtn.onclick = () => {
    if(!gameStarted) return;
    paused = true;
    pauseBtn.style.display = "none";
    resumeBtn.style.display = "inline";
};
resumeBtn.onclick = () => {
    paused = false;
    resumeBtn.style.display = "none";
    pauseBtn.style.display = "inline";
};

// ==================== FUNCIONES ====================
document.addEventListener("keydown", e => keys[e.key]=true);
document.addEventListener("keyup", e => keys[e.key]=false);
const keys = {};

function startLevel(isBoss=false){
    gameStarted=true;
    paused=false;
    inBossLevel=isBoss;
    score=0;
    hearts=[];
    enemies=[];
    if(!isBoss){
        goal = levelGoals[level-1];
    } else {
        bossHP = 10;
        boss={x:450,y:100,size:80,vx:2};
    }
    updateUI();
    spawnObjects();
}

function resetLevel(){
    lives=3;
    level=1;
    startLevel();
    gameOverScreen.style.display="none";
}

function updateUI(){
    document.getElementById("score").textContent="â™¡ Almas: "+score;
    document.getElementById("lives").textContent="ðŸ’– Vidas: "+lives;
    document.getElementById("level").textContent="Nivel: "+level;
    if(!inBossLevel) document.getElementById("goal").textContent="Meta: "+goal+" corazones";
    else document.getElementById("goal").textContent="Derrota al Jefe!";
}

// ------------------- SPAWN CORAZONES Y ENEMIGOS -------------------
function spawnObjects(){
    if(!inBossLevel){
        heartsInterval = setInterval(()=>{hearts.push({x:Math.random()*canvas.width,y:Math.random()*canvas.height,size:20,floatOffset:Math.random()*Math.PI*2});},1500);
        enemiesInterval = setInterval(()=>{enemies.push({x:Math.random()*canvas.width,y:-20,size:25,speed:1+level*0.3,floatOffset:Math.random()});},2000);
    }
}

// ==================== DIBUJAR ====================
function drawShark(){
    const skin = skins[currentSkin];
    ctx.save();
    ctx.translate(shark.x,shark.y);
    shark.blink+=0.05; shark.finWave+=0.1;
    const blinkValue=Math.abs(Math.sin(shark.blink));
    const finRotation=Math.sin(shark.finWave)*0.3;
    ctx.fillStyle=skin.body;
    ctx.beginPath();
    ctx.ellipse(0,0,shark.size,shark.size*0.6,0,0,Math.PI*2);
    ctx.fill();
    ctx.save();
    ctx.rotate(finRotation);
    ctx.fillStyle=skin.tail;
    ctx.beginPath();
    ctx.moveTo(-25,0); ctx.lineTo(-45,-15); ctx.lineTo(-45,15); ctx.closePath(); ctx.fill();
    ctx.restore();
    ctx.fillStyle=skin.eye;
    ctx.beginPath();
    ctx.ellipse(-10,-5,5,5*(0.3+blinkValue),0,0,Math.PI*2);
    ctx.ellipse(10,-5,5,5*(0.3+blinkValue),0,0,Math.PI*2);
    ctx.fill();
    ctx.restore();
}

function drawHearts(){
    hearts.forEach((h,i)=>{
        h.y+=Math.sin(Date.now()/500+h.floatOffset)*0.3;
        ctx.save(); ctx.translate(h.x,h.y);
        ctx.fillStyle="#ff69f7";
        ctx.beginPath();
        ctx.moveTo(0,0);
        ctx.bezierCurveTo(-10,-10,-20,10,0,20);
        ctx.bezierCurveTo(20,10,10,-10,0,0);
        ctx.fill();
        ctx.restore();
        if(Math.hypot(h.x-shark.x,h.y-shark.y)<shark.size){
            hearts.splice(i,1); score++; updateUI();
            if(!inBossLevel && score>=goal){ clearIntervals(); levelCompleted(); }
        }
    });
}

function drawEnemies(){
    enemies.forEach((e,i)=>{
        e.y+=e.speed; e.x+=Math.sin(Date.now()/400+e.floatOffset)*1.5;
        ctx.save(); ctx.translate(e.x,e.y);
        ctx.fillStyle="#9e6bff";
        ctx.beginPath(); ctx.arc(0,0,e.size,Math.PI,0); ctx.quadraticCurveTo(e.size,20,0,20); ctx.quadraticCurveTo(-e.size,20,-e.size,0); ctx.fill();
        ctx.fillStyle="#000"; ctx.beginPath(); ctx.arc(-10,-5,5,0,Math.PI*2); ctx.arc(10,-5,5,0,Math.PI*2); ctx.fill(); ctx.restore();
        if(Math.hypot(e.x-shark.x,e.y-shark.y)<shark.size){ loseLife(); }
    });
}

function drawBoss(){
    if(!boss) return;
    boss.x+=boss.vx;
    if(boss.x<80 || boss.x>canvas.width-80) boss.vx*=-1;
    ctx.save(); ctx.translate(boss.x,boss.y);
    ctx.fillStyle="#ff0044";
    ctx.beginPath(); ctx.arc(0,0,boss.size,0,Math.PI*2); ctx.fill();
    // Punto dÃ©bil
    ctx.fillStyle="#ffff00"; ctx.beginPath(); ctx.arc(0,0,15,0,Math.PI*2); ctx.fill();
    ctx.restore();
    if(Math.hypot(shark.x-boss.x,shark.y-boss.y)<shark.size+boss.size){
        bossHP--;
        if(bossHP<=0){ messageText.textContent=levelMessages[9]; message.style.display="block"; clearIntervals(); boss=null; paused=true; }
    }
}

function loseLife(){
    lives--; updateUI();
    if(lives<=0){ gameOverScreen.style.display="block"; clearIntervals(); }
    else { shark.x=450; shark.y=280; }
}

function clearIntervals(){ clearInterval(heartsInterval); clearInterval(enemiesInterval); }

function levelCompleted(){
    messageText.textContent = levelMessages[level-1];
    message.style.display = "block";
    paused = true;
}

// ==================== MOVIMIENTO ====================
function updatePlayer(){
    if(!gameStarted || paused) return;
    shark.vx=0; shark.vy=0;
    if(keys["ArrowLeft"]||keys["a"]) shark.vx=-shark.speed;
    if(keys["ArrowRight"]||keys["d"]) shark.vx=shark.speed;
    if(keys["ArrowUp"]||keys["w"]) shark.vy=-shark.speed;
    if(keys["ArrowDown"]||keys["s"]) shark.vy=shark.speed;
    shark.x+=shark.vx; shark.y+=shark.vy;
    shark.x=Math.max(shark.size,Math.min(canvas.width-shark.size,shark.x));
    shark.y=Math.max(shark.size,Math.min(canvas.height-shark.size,shark.y));
}

// ==================== LOOP ====================
function gameLoop(){
    ctx.fillStyle=levelBackgrounds[level-1]; 
    ctx.fillRect(0,0,canvas.width,canvas.height);

    if(!paused && gameStarted){
        updatePlayer();
        drawShark();
        drawHearts();
        drawEnemies();
        if(inBossLevel) drawBoss();
    } else if(paused && gameStarted){
        // Mensaje Pausado
        ctx.fillStyle="rgba(0,0,0,0.5)";
        ctx.fillRect(0,0,canvas.width,canvas.height);
        ctx.fillStyle="#ffccf5";
        ctx.font="40px Comic Sans MS";
        ctx.fillText("PAUSADO", canvas.width/2-80, canvas.height/2);
    }

    requestAnimationFrame(gameLoop);
}

gameLoop();

// ==================== BOTÃ“N SIGUIENTE NIVEL ====================
nextLevelBtn.onclick = () => {
    message.style.display = "none";
    paused = false;
    level++;
    if(level > 10){
        alert("Â¡Felicidades! Has completado todos los niveles ðŸŽ‰");
        location.reload();
        return;
    }
    if(level === 10){
        bossInfo.style.display = "block";
    } else {
        startLevel();
    }
};
</script>

</body>
</html>


